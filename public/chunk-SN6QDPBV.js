import{a as h}from"./chunk-4IIHO7PN.js";import{F as y,K as u,Z as g,k as d,x as m}from"./chunk-JAN5YDZQ.js";import{l as r}from"./chunk-FJC5RNOW.js";var T=h("Geolocation",{web:()=>import("./chunk-NPHSWHBQ.js").then(s=>new s.GeolocationWeb)});function v(s,o,p,e){let i=l(p-s),n=l(e-o),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(l(s))*Math.cos(l(p))*Math.sin(n/2)*Math.sin(n/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}function l(s){return s*(Math.PI/180)}var w=(()=>{let o=class o{constructor(){}isWithinKilometers(e,t){return v(t.lat1,t.lon1,t.lat2,t.lon2)<=e}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=d({token:o,factory:o.\u0275fac,providedIn:"root"});let s=o;return s})();var L=(()=>{let o=class o{constructor(e){this.distanceService=e,this.navigateTo=new m,this.radiusInKm=100,this.printCurrentPosition=()=>r(this,null,function*(){let t=yield T.getCurrentPosition();return console.log("Current",t),this.cpos={lat:t.coords.latitude,lng:t.coords.longitude},{lat:t.coords.latitude,lng:t.coords.longitude}}),this.bleep=new Audio,this.bleep.src="/assets/sound/pop.mp3",this.bleep.load()}ngOnInit(){return r(this,null,function*(){let e=yield this.printCurrentPosition();this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:e==null?void 0:e.lat,lng:e==null?void 0:e.lng},zoom:12,styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#6195a0"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#e6f3d6"},{visibility:"on"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#f4d2c5"},{visibility:"simplified"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{color:"#4e4e4e"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#f4f4f4"}]},{featureType:"road.arterial",elementType:"labels.text.fill",stylers:[{color:"#787878"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#eaf6f8"},{visibility:"on"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#eaf6f8"}]}],mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,zoomControl:!0,scaleControl:!1,rotateControl:!1,gestureHandling:"greedy",clickableIcons:!1,disableDefaultUI:!0});let t=this.getMarkers();t.map(i=>r(this,null,function*(){let n={lat1:e==null?void 0:e.lat,lon1:e==null?void 0:e.lng,lat2:i.position.lat,lon2:i.position.lng},a=this.distanceService.isWithinKilometers(this.radiusInKm,n);i.display=a})),t&&this.setMarkers(t,this.map)})}getMarkers(){let e=[];if(sessionStorage.getItem("markers")!=null&&sessionStorage.getItem("markers")){let t=sessionStorage.getItem("markers");e=t?JSON.parse(t):null}return e}setMarkers(e,t){e.map((i,n)=>{let a=`
        <div id="content">
          <div id="siteNotice">
          </div>
          <img src="assets/icon/favicon.png" alt="logo" style="width: 50px; height: 50px;"/>
          <h1 id="firstHeading" class="firstHeading">${i.name}</h1>
          <div id="bodyContent">
            <p>${i.description}</p>
           
            <button id="seeMoreButton-${n}">See More</button
          </div>
        </div>
      `;if(i.display){let c=new google.maps.Marker({position:{lat:i.position.lat,lng:i.position.lng},map:t,title:i.name,icon:{url:i.icon,scaledSize:new google.maps.Size(50,50)}}),f=new google.maps.InfoWindow({content:a});c.addListener("click",()=>{this.runBleep(),f.open(t,c),setTimeout(()=>{this.addInfoWindowClickListener(n,i)},300)})}})}addInfoWindowClickListener(e,t){let i=document.getElementById(`seeMoreButton-${e}`);i&&i.addEventListener("click",()=>{this.openPublicFacing(t)})}openPublicFacing(e){this.navigateTo.emit(e)}runBleep(){this.bleep.play()}};o.\u0275fac=function(t){return new(t||o)(y(w))},o.\u0275cmp=u({type:o,selectors:[["app-map"]],outputs:{navigateTo:"navigateTo"},decls:1,vars:0,consts:[["id","map",2,"height","80vh"]],template:function(t,i){t&1&&g(0,"div",0)},styles:[".info-window-content[_ngcontent-%COMP%]{min-width:200px;max-width:400px}"]});let s=o;return s})();export{L as a};
