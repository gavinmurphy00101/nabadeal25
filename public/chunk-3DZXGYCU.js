import{c as l,d as I}from"./chunk-RS6KSRCG.js";import{a as L}from"./chunk-3QBIDXIL.js";import{c as z,e as G,f as K,g as w,i as X,k as Y,m as b,n as Z,o as _,p as ee,q as u,r as E,s as se,t as T}from"./chunk-FA7MAQ6Q.js";import{$ as U,Ba as M,Ja as q,O as f,Ob as V,Qa as y,T as $,U as N,Ub as W,Vb as H,Wa as Q,a as d,ea as g,fa as B,h as P,i as k,la as R,n as p,o as A,ob as J,q as O,r as S,va as D}from"./chunk-BCBC4TJ6.js";import"./chunk-JVVX3GNW.js";import"./chunk-S4RDXBED.js";import"./chunk-74AOXQD3.js";import"./chunk-PQZPJ2TO.js";import"./chunk-G3CV3VGG.js";import"./chunk-MB6GPW3H.js";import"./chunk-BOJC7UTE.js";import"./chunk-DFM4XHD4.js";import"./chunk-4U6PRYVA.js";import"./chunk-34NJY46B.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{a as h,l as F}from"./chunk-FJC5RNOW.js";var x=(()=>{let i=class i{};i.\u0275fac=function(s){return new(s||i)},i.\u0275mod=N({type:i}),i.\u0275inj=A({imports:[y]});let c=i;return c})();var j=(()=>{let i=class i{constructor(){this.firestore=S(z)}addBusiness(e){let s=w(this.firestore,"businesses");return K(s,e)}getBusinesses(){let e=w(this.firestore,"businesses");return G(e,{idField:"id"})}};i.\u0275fac=function(s){return new(s||i)},i.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"});let c=i;return c})();var te=(()=>{let i=class i{constructor(e){this.db=e}get(e){let s=u(this.db,e);return new d(t=>{b(s,n=>{let o=n.val(),r=o?Object.values(o):[];t.next(r),t.complete()},n=>{t.error(n)})})}add(e,s){let t=_(u(this.db,e));return se(t,s)}update(e,s,t){switch(e){case"businesses":let r=h({},t),a=u(this.db,e+`/${s}`);return T(a,r);case"users":let m=h({},t),v=u(this.db,e+`/${s}`);return T(v,m)}let n=h({},t),o=u(this.db,e+`/${s}`);return T(o,n)}delete(e,s){let t=u(this.db,e+`/${s}`);return E(t)}getAllBusinessIds(e){let s=u(this.db,e);return new d(t=>{b(s,n=>{let o=n.val(),r=o?Object.keys(o):[];t.next(r),t.complete()},n=>{t.error(n)})})}getByFieldValue(e,s,t){let n=u(this.db,e),o=ee(n,Z(s),Y(t));return new d(r=>{b(o,a=>{let m=a.val(),v=m?Object.values(m):[];r.next(v),r.complete()},a=>{r.error(a)})})}getById(e,s){let t=u(this.db,`${e}/${s}`);return this.byDataType(t,e)}getIdById(e,s){let t=u(this.db,`${e}/${s}`);return new d(n=>{b(t,o=>{o.exists()?n.next(s):n.error(new Error("Business not found")),n.complete()},o=>{n.error(o)})})}byDataType(e,s){switch(s){case"businesses":return new d(t=>{b(e,n=>{let o=n.val();o?t.next(o):t.error(new Error("Business not found")),t.complete()})});default:return P(null)}}deleteEntireDatabase(){let e=u(this.db,"/");return E(e)}getBusinessCategoryAndEmailById(e,s,t){let n=u(this.db,`${e}/${s}`);return new d(o=>{b(n,r=>{let a=r.val();if(a){let m=this.getSelectedFields(t,a);o.next(m)}else o.error(new Error("Business not found"));o.complete()},r=>{o.error(r)})})}getSelectedFields(e,s){let t={};return e.forEach(n=>{t[n]=s[n]}),t}};i.\u0275fac=function(s){return new(s||i)(O(X))},i.\u0275prov=p({token:i,factory:i.\u0275fac,providedIn:"root"});let c=i;return c})();var ve=(()=>{let i=class i{constructor(e,s,t,n,o){this.navigationService=e,this.route=s,this.cdr=t,this.firestoreService=n,this.RTDB=o,this.businessDetails={activeDeal:"active",businessName:"string",description:"string",businessPhone:"string",businessEmail:"string",businessWebsite:"string",businessCategory:"string",businessFormattedAddress:"string",businessImageUrl:"string",businessAddress:"string"},this.isLoading=!1,this.businesses=[]}ngOnInit(){return F(this,null,function*(){let e=yield this.getAllBusinessIds()})}getBusinessidbyid(){this.RTDB.getIdById(l.Businesses,"-OIbkJNcPqQjwTUb26ij").subscribe(s=>{console.log("Fetched business:",s)})}getAllBusinessIds(){return F(this,null,function*(){return yield k(this.RTDB.getAllBusinessIds(l.Businesses))})}updateBusiness(){let e={[I.ActiveDeal]:"true"};console.log("fieldsToUpdate:",e),this.RTDB.update(l.Businesses,"-OIbkJNcPqQjwTUb26ij",e)}getBusinessCategorys(){let e="-OIbkJNcPqQjwTUb26ij",s=[I.ActiveDeal,I.Description];this.RTDB.getBusinessCategoryAndEmailById(l.Businesses,e,s).subscribe(t=>{console.log("Fetched business:",t)})}addBusinessToFirestore(){this.firestoreService.addBusiness(this.businessDetails).then(e=>{console.log("Business added to Firestore successfully",e)}).catch(e=>{console.error("Error adding business to Firestore: ",e)})}fetchBusinesses(){this.firestoreService.getBusinesses().subscribe(e=>{this.businesses=e,console.log("Fetched businesses:",e)})}getParams(){this.route.paramMap.subscribe(e=>{var s,t,n,o,r,a;this.businessDetails.activeDeal=(s=e.get("activeDeal"))!=null?s:"a",this.businessDetails.businessName=(t=e.get("name"))!=null?t:"b",this.businessDetails.description=(n=e.get("description"))!=null?n:"c",this.businessDetails.businessEmail=(o=e.get("businessEmail"))!=null?o:"d",this.businessDetails.businessPhone=(r=e.get("businessPhone"))!=null?r:"e",this.businessDetails.businessWebsite=(a=e.get("businessWebsite"))!=null?a:"f",this.cdr.detectChanges()})}getBusinessById(){debugger;this.RTDB.getById(l.Businesses,"-OIbkJNcPqQjwTUb26ij").subscribe(s=>{console.log("Fetched business:",s)})}addBusinessToRTDB(){for(let s=0;s<0;s++)setInterval(()=>{},500);this.businessDetails.activeDeal="notactive",this.RTDB.add(l.Businesses,this.businessDetails).then(s=>{console.log("Business added to Realtime Database successfully",s)}).catch(s=>{console.error("Error adding business to Realtime Database: ",s)})}};i.\u0275fac=function(s){return new(s||i)(f(L),f(Q),f(q),f(j),f(te))},i.\u0275cmp=$({type:i,selectors:[["app-payment"]],features:[M([j,x])],decls:8,vars:1,consts:[[3,"translucent"],[3,"click"]],template:function(s,t){s&1&&(g(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),D(3,"payment"),B()()(),g(4,"button",1),R("click",function(){return t.addBusinessToFirestore()}),D(5,"Add Business"),B(),g(6,"button",1),R("click",function(){return t.addBusinessToRTDB()}),D(7,"Add Businessto RTDB"),B()),s&2&&U("translucent",!0)},dependencies:[V,W,H,y,J,x],encapsulation:2});let c=i;return c})();export{ve as PaymentPage};
